# 项目需求文档

> **说明**：本需求文档旨在描述一个可视化平台，用于上传、处理及分析 PDF 文件，并通过图形化方式展示文档与实体之间的关系。文档包含功能需求、系统架构、非功能性需求等内容，仅作示例参考。请根据实际项目需求进行增改。

---

## 一、项目概述

### 1. 项目名称

PDF 文档实体识别与关系可视化平台

### 2. 项目目标

- 搭建一个可在浏览器中使用的可视化平台，让用户可以**上传 PDF 文件**，系统自动完成以下任务：
  1. 将 PDF 文件转换为 DOCX 文档。  
  2. 把 DOCX 文档解析并简化为 JSON。  
  3. 对文本内容进行 NLP 实体识别（通过 SpaCy），将结果保存至数据库。  
  4. 在前端界面，通过表格、图表、知识图谱等方式**可视化展示**文档与实体之间的关联关系。

### 3. 主要功能点

- **用户界面：**
  1. 上传 PDF 文件  
  2. 查看已经上传并处理的所有 PDF 列表  
  3. 查看某个 PDF 文件提取出的实体列表  
  4. 关系图或其他可视化方式展示论文（文档）与实体之间的关联  
  5. 提供搜索或高级查询功能（如“查找提到组织 X 的所有文档”）

- **后台核心功能：**
  1. 读取配置/索引文件（index.xlsx），或由用户在前端上传并写入数据库  
  2. 调用现有 Python 脚本，执行 PDF -> DOCX -> JSON 转换  
  3. 利用 SpaCy 对文本执行实体识别，并将识别结果写入数据库  
  4. 维护三张核心表：`papers`, `entities`, `papers_have_entities`  
  5. 提供 RESTful API 或 GraphQL API，供前端获取数据

### 4. 目标受众

- **研究人员、学者**：快速将文献库中 PDF 文件的关键信息提取出来，减少阅读时间。  
- **组织或企业**：对海量 PDF 文档进行结构化处理和实体抽取，以搭建信息检索或知识管理系统。

---

## 二、功能需求

### 2.2 PDF 文件管理

1. **PDF 上传**  
   - 用户在前端选择一个或多个 PDF 文件进行上传  
   - 后端接收文件并存储至服务器指定目录（如 `Papers/`）  
   - 数据库中创建或更新记录，标记文件状态（如“未处理”、“处理中”、“已处理”等）

2. **文件处理**  
   - **自动调用**核心脚本流程：  
     1. `pdf2docx.parse()`：PDF 转换为 DOCX  
     2. `simplify_docx.simplify()`：DOCX 转换为 JSON  
     3. 使用 SpaCy 加载 NLP 模型，对文本执行实体识别  
   - 实体识别结果存储至数据库
   - 处理进度在前端显示（进度条、状态更新等）

3. **文件列表**  
   - 前端界面显示已上传的所有 PDF 文件及其处理状态  
   - 提供简单检索和过滤（按文件名、状态等）

### 2.3 实体与关系管理

1. **实体查看**  
   - 展示某篇 PDF 文件提取到的实体列表  
   - 按实体类型（PERSON、ORG、WORK_OF_ART 等）进行过滤  
   - 显示在该文档中出现的次数（`papers_have_entities.count`）

2. **全局实体搜索/查询**  
   - 在前端输入实体名称或类型，搜索对应的所有文档  
   - 支持“与 / 或”逻辑：  
     - 示例：“查找同时提到组织 OpenAI 和个人 John Doe 的所有文档”  
   - 后端可调用自然语言转 SQL 功能或直接提供标准 SQL API

3. **实体关系可视化**  
   - 通过图形化展示**知识图谱**：节点代表 `papers` 或 `entities`，连线表示“提及”关系  
   - 可视化工具可选 D3.js、Cytoscape.js、echarts、vis.js 等  
   - 不同颜色或大小展示实体类型、出现频次

4. **统计报表（可选）**  
   - 最常提到的实体排行榜  
   - 按时间或文档类别聚合统计  
   - 生成饼图、柱状图或折线图等可视化报表

### 2.4 系统设置与管理（可选）

- **索引文件管理**  
  - 如果继续使用 `index.xlsx` 维护文档索引，需提供前端上传/更新方式，或直接由后台自动更新数据库
- **批量处理**  
  - 管理员一次性批量上传 PDF，系统后端自动进行转换和实体识别
- **日志与监控**  
  - 每次 PDF 处理流程都记录日志，便于排查问题  
  - 提供界面查看处理日志

---

## 三、系统架构与技术选型

### 3.1 前端

- 推荐使用 **React** / **Vue.js** / **Angular** 搭建单页应用（SPA）
- 主要模块：
  - 文件上传组件  
  - 文件列表 / 详情展示  
  - 图形可视化（D3.js、Cytoscape.js 或其他库）

### 3.2 后端

- 基于 **Python + Flask / FastAPI / Django** 搭建 Web 服务
- 提供以下 API：
  - 文件上传 API  
  - 文件及实体查询 API  
  - 图形可视化数据 API（返回节点与边的 JSON 结构）
- 集成现有脚本功能：PDF -> DOCX -> JSON -> NLP 实体识别

### 3.3 数据库

- 可使用 **SQLite**（轻量
- 主要表结构：
  - `papers`：存储文件信息  
  - `entities`：存储识别到的实体  
  - `papers_have_entities`：实体与文档的映射关系

### 3.4 文件存储

- PDF、DOCX 及 JSON 文件保存于服务器文件系统
- 数据库存储文件路径与元数据

### 3.5 NLP 模型

- **SpaCy** (`en_core_web_trf`)  
- 可视需求扩展或更换其他模型
- 支持并行或流水线处理大批量文档

---

## 四、交互流程（示例）

1. **上传 PDF 文件**
   - 用户本地选择文件  
   - 前端将文件流提交给后端  
   - 后端存储并插入数据库记录，状态初始为“未处理”
2. **自动处理**
   1. `pdf2docx.parse()` -> DOCX  
   2. `simplify_docx.simplify()` -> JSON  
   3. `spacy.load()` 对文本进行实体识别  
   4. 写入 `entities`、`papers_have_entities`  
   5. 更新状态为“已处理”
3. **查看结果**
   - 在“文档列表”界面，点击某个文件查看详情  
   - 显示主要文本段落、实体列表及频次  
   - “可视化”按钮展示当前文档和实体的关联图
4. **查询实体**
   - 用户搜索“person John Doe”或“organisation OpenAI”  
   - 后端返回匹配的所有文档  
   - 可切换图形模式查看多篇文档与实体的网络关系

---

## 五、非功能性需求

1. **性能**
   - 数十页 PDF 的转换与识别在合理时间（1-2 分钟）内完成  
   - 数据查询应在秒级响应

2. **安全性**
   - 若系统对外开放，需启用 HTTPS，加设文件大小限制与输入验证  
   - 数据库和文件访问权限严格控制

3. **可扩展性**
   - 预留 API 接口，便于后续集成更多 NLP 功能（如情感分析、自动摘要、关系抽取等）  
   - 若数据量较大，可从 SQLite 升级到 PostgreSQL/MySQL

4. **可维护性**
   - 前后端分离，代码结构清晰  
   - 推荐使用容器化（Docker）部署，方便迁移与升级

5. **多语言支持（可选）**
   - 使用 i18n 库对前端界面进行多语言处理  
   - 若需支持多语种实体识别，则需相应语言模型

---

## 六、里程碑与交付物

1. **MVP（最小可行产品）**
   - 前后端框架搭建  
   - 实现 PDF 文件上传和自动处理  
   - 显示基本结果（列表 + 简单可视化）

2. **Beta 版本**
   - 增加用户登录 / 权限管理（如需要）  
   - 高级查询功能（自然语言转 SQL 或直接 SQL 接口）  
   - 实体可视化及统计分析

3. **正式发布**
   - 部署到服务器并编写文档  
   - 完成性能与安全优化  
   - 日志、监控和备份策略落地

---

## 七、实施建议

1. **团队角色**
   - **全栈开发 / 前端开发**：实现网站界面  
   - **后端开发**：API、数据库、调度核心脚本  
   - **NLP 工程师（可兼职）**：负责实体识别和模型优化  
   - **测试工程师**：负责测试与质量保证

2. **项目管理**
   - 采用 **Agile/Scrum**，每个冲刺（Sprint）1-2 周  
   - 定期与需求方沟通，确定优先级

3. **部署与运维**
   - 先在测试环境完成评估  
   - 建议使用 Docker 或虚拟机快速搭建环境  
   - 建立日志监控系统，及时发现并解决问题

---

## 八、附加想法与功能扩展（可选）

1. **文本高亮**
   - 在前端界面展示文档主要内容，并高亮显示识别到的实体

2. **文档合并与去重**
   - 对重复或相似度高的 PDF 文档进行合并或标记

3. **实体编辑或合并**
   - 用户可手动修正识别错误的实体，或合并近似实体

4. **自动摘要生成**
   - 通过额外的 NLP 模型，自动为文档生成摘要

5. **关系抽取**
   - 识别实体间更复杂的关系（如“Person A is founder of Org B”）

6. **可视化导出**
   - 关系图或统计报表可导出为 PDF、图片或 JSON

---

> 以上内容仅为示例性项目需求文档，具体需求请根据实际使用场景进行裁剪与调整。